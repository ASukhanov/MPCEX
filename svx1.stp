' Stapl file for downloading two SVXs
' Version 7, 2016-04-30 High gain: RRG=111, High BW: BW=1111, 
<<<<<<< HEAD
'   Latency4: LAT=000100, RTPS off: R=1.
=======
'   Latency5: LAT=000101, RTPS off: R=1.
>>>>>>> 043f0a36b4031f65b456c428cc940ce3dc6f608d
'
' #.9.........8.........7.........6.........5.........4.........3.........2.........1.........0.........9.........8.........7.........6.........5.........4.........3.........2.........1.........;
' #.9.LF......8.........RRG.......6...^^ID^^^R^Lat^^IRIWIsel^BW^DVx.......2.........1.........0.........9.........8.........7.........6.........5.........4.........3.........2.........1.........;
' #111000000000100000001000001010111110010000000011001011000110001010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000001
ACTION	TRANS = DO_TRANS;
DATA PARAMETERS;
BOOLEAN chip1[192];
BOOLEAN chip2[192];
BOOLEAN irdata[10*32];
ENDDATA;
PROCEDURE DO_TRANS USES PARAMETERS;
' Load sequencer with single command '18'
IRSCAN 8, $16, CAPTURE irdata[7..0];
DRSCAN 32, $1ff00000, CAPTURE irdata[31..0];
DRSCAN 32, $00000018, CAPTURE irdata[31..0];
DRSCAN 32, $00120000, CAPTURE irdata[31..0];
DRSCAN 32, $80200000, CAPTURE irdata[31..0];
' Start downloading
IRSCAN 8, $18, CAPTURE irdata[7..0];
'Last chip flag = 0
'           #.9.LF......8.........RRG.......6..R^^ID^^^.^Lat^^IRIWIsel^BW^DVx
<<<<<<< HEAD
DRSCAN 192, #100100000000100000001111001010111110011100000010001011000111101010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000001, CAPTURE chip1[191..0];
EXPORT "Shifted out chip12:", chip1[191..0];
'First chip flag = 0
'           #.9.LF......8.........RRG.......6..R^^ID^^^.^Lat^^IRIWIsel^BW^DVx
DRSCAN 192, #100010000000100000001111001010111111000100000010001011000111101010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000001, CAPTURE chip1[191..0];
=======
DRSCAN 192, #100100000000100000001111001010111110011100000010101011000111101010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000001, CAPTURE chip1[191..0];
EXPORT "Shifted out chip12:", chip1[191..0];
'First chip flag = 0
'           #.9.LF......8.........RRG.......6..R^^ID^^^.^Lat^^IRIWIsel^BW^DVx
DRSCAN 192, #100010000000100000001111001010111111000100000010101011000111101010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000001, CAPTURE chip1[191..0];
>>>>>>> 043f0a36b4031f65b456c428cc940ce3dc6f608d
EXPORT "Shifted out chip01:", chip1[191..0];

ENDPROC;

